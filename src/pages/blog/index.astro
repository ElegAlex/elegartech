---
import { getCollection } from 'astro:content';
import BaseLayout from '@layouts/BaseLayout.astro';
import ArticleCard from '@components/ArticleCard.astro';

const allPosts = await getCollection('blog', ({ data }) => {
  return !data.draft && data.date <= new Date();
});

const sortedPosts = allPosts.sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());
---

<BaseLayout
  title="Tous les articles | ElegarTech"
  description="Tous les articles du blog ElegarTech : IA, développement, sécurité, systèmes et analyses techniques."
>
  <section class="py-12 px-4">
    <div class="max-w-6xl mx-auto">
      <header class="mb-12">
        <a
          href="/"
          class="inline-flex items-center gap-1 text-sm text-[var(--text-secondary)] hover:text-[var(--accent-primary)] mb-4"
        >
          ← Retour à l'accueil
        </a>
        <h1 class="text-3xl md:text-4xl font-bold mb-2">Tous les articles</h1>
        <p class="text-[var(--text-secondary)]">
          {sortedPosts.length} article{sortedPosts.length > 1 ? 's' : ''}
        </p>
      </header>

      {sortedPosts.length > 0 ? (
        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
          {sortedPosts.map((post) => (
            <ArticleCard post={post} />
          ))}
        </div>
      ) : (
        <div class="text-center py-16">
          <p class="text-[var(--text-secondary)]">
            Aucun article pour le moment.
          </p>
        </div>
      )}
    </div>
  </section>
</BaseLayout>
